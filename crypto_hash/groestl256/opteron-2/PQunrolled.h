inline void P512ASM (u64 *x) {
  asm (
       /* Round 0: */
       "\n	movq	8(%0), %%rax"
       "\n	movq	24(%0), %%rbx"
       "\n	movq	0(%0), %%rcx"
       "\n	movq	16(%0), %%rdx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"

       /* Round 1: */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$1, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"

       /* Round 2: */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$2, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 3 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$3, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 4 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$4, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 5 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$5, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 6 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$6, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 7 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$7, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 8 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$8, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 9 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	xorq	$9, %%rcx" /* xor round constant */

       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"


       "\n	movq	%%r11, 8(%0)"
       "\n	movq	%%mm3, 24(%0)"
       "\n	movq	%%r10, 0(%0)"
       "\n	movq	%%mm2, 16(%0)"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       : /*no output, only memory is modified */
       : "r" (x) /* input variable: x */
       : "%rax", "%rbx", "%rcx", "%rdx", "%rdi", "%rsi", "%r8", "%r10", "%r11", "memory" , "%mm2" , "%mm3" , "%mm4" , "%mm5" , "%mm6" , "%mm7" );
}//P512ASM()


inline void Q512ASM (u64 *x) {
  asm (
       /* Round 0: */
       "\n	movq	8(%0), %%rax"
       "\n	movq	24(%0), %%rbx"
       "\n	movq	0(%0), %%rcx"
       "\n	movq	16(%0), %%rdx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$255, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"

       /* Round 1: */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$254, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"

       /* Round 2: */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$253, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 3 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$252, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 4 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$251, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 5 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$250, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 6 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$249, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 7 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$248, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 8 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$247, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"

       "\n	movq	%%r11, %%rax"
       "\n	movq	%%mm3, %%rbx"
       "\n	movq	%%r10, %%rcx"
       "\n	movq	%%mm2, %%rdx"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       /* Round 9 */
       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T0(,%%rdi,8), %%r11 # col1' = R(col1)"
       "\n	movq	T1(,%%rsi,8), %%r10 # col0' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	movq	T0(,%%rdi,8), %%mm3 # col3' = R(col3)"
       "\n	movq	T1(,%%rsi,8), %%mm2 # col2' = R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T2(,%%rdi,8), %%mm7 # col7' = R(col1)"
       "\n	movq	T3(,%%rsi,8), %%mm6 # col6' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r11 # col1' += R(col3)"
       "\n	xorq	T3(,%%rsi,8), %%r10 # col0' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	movq	T4(,%%rdi,8), %%mm5 # col5' = R(col1)"
       "\n	movq	T5(,%%rsi,8), %%mm4 # col4' = R(col1)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm7 # col7' += R(col3)"
       "\n	pxor	T5(,%%rsi,8), %%mm6 # col6' += R(col3)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm3 # col3' += R(col1)"
       "\n	pxor	T7(,%%rsi,8), %%mm2 # col2' += R(col1)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm5 # col5' += R(col3)"
       "\n	pxor	T7(,%%rsi,8), %%mm4 # col4' += R(col3)"


       "\n	movq	40(%0), %%rax"
       "\n	movq	56(%0), %%rbx"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	T0(,%%rdi,8), %%r10 # col0' += R(col0)"
       "\n	pxor	T1(,%%rsi,8), %%mm7 # col7' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm2 # col2' += R(col2)"
       "\n	xorq	T1(,%%rsi,8), %%r11 # col1' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm6 # col6' += R(col0)"
       "\n	pxor	T3(,%%rsi,8), %%mm5 # col5' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	xorq	T2(,%%rdi,8), %%r10 # col0' += R(col2)"
       "\n	pxor	T3(,%%rsi,8), %%mm7 # col7' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm4 # col4' += R(col0)"
       "\n	pxor	T5(,%%rsi,8), %%mm3 # col3' += R(col0)"
       "\n	shrq	$16, %%rcx"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm6 # col6' += R(col2)"
       "\n	pxor	T5(,%%rsi,8), %%mm5 # col5' += R(col2)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	xorq	$246, %%rsi" /* xor round constant */
       "\n	pxor	T6(,%%rdi,8), %%mm2 # col2' += R(col0)"
       "\n	xorq	T7(,%%rsi,8), %%r11 # col1' += R(col0)"

       "\n	movzbl	%%dl, %%edi"
       "\n	movzbl	%%dh, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm4 # col4' += R(col2)"
       "\n	pxor	T7(,%%rsi,8), %%mm3 # col3' += R(col2)"


       "\n	movq	32(%0), %%rcx"
       "\n	movq	48(%0), %%rdx"


       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm5 # col5' += R(col5)"
       "\n	pxor	T1(,%%rsi,8), %%mm4 # col4' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T0(,%%rdi,8), %%mm7 # col7' += R(col7)"
       "\n	pxor	T1(,%%rsi,8), %%mm6 # col6' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm3 # col3' += R(col5)"
       "\n	pxor	T3(,%%rsi,8), %%mm2 # col2' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T2(,%%rdi,8), %%mm5 # col5' += R(col7)"
       "\n	pxor	T3(,%%rsi,8), %%mm4 # col4' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	xorq	T4(,%%rdi,8), %%r11 # col1' += R(col5)"
       "\n	xorq	T5(,%%rsi,8), %%r10 # col0' += R(col5)"
       "\n	shrq	$16, %%rax"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	pxor	T4(,%%rdi,8), %%mm3 # col3' += R(col7)"
       "\n	pxor	T5(,%%rsi,8), %%mm2 # col2' += R(col7)"
       "\n	shrq	$16, %%rbx"

       "\n	movzbl	%%al, %%edi"
       "\n	movzbl	%%ah, %%esi"
       "\n	pxor	T6(,%%rdi,8), %%mm7 # col7' += R(col5)"
       "\n	pxor	T7(,%%rsi,8), %%mm6 # col6' += R(col5)"

       "\n	movzbl	%%bl, %%edi"
       "\n	movzbl	%%bh, %%esi"
       "\n	xorq	T6(,%%rdi,8), %%r11 # col1' += R(col7)"
       "\n	xorq	T7(,%%rsi,8), %%r10 # col0' += R(col7)"


       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T0(,%%rdi,8), %%mm4 # col4' += R(col4)"
       "\n	pxor	T1(,%%rsi,8), %%mm3 # col3' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T0(,%%rax,8), %%mm6 # col6' += R(col6)"
       "\n	pxor	T1(,%%rbx,8), %%mm5 # col5' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T2(,%%rdi,8), %%mm2 # col2' += R(col4)"
       "\n	xorq	T3(,%%rsi,8), %%r11 # col1' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T2(,%%rax,8), %%mm4 # col4' += R(col6)"
       "\n	pxor	T3(,%%rbx,8), %%mm3 # col3' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	xorq	T4(,%%rdi,8), %%r10 # col0' += R(col4)"
       "\n	pxor	T5(,%%rsi,8), %%mm7 # col7' += R(col4)"
       "\n	shrq	$16, %%rcx"
       "\n	pxor	T4(,%%rax,8), %%mm2 # col2' += R(col6)"
       "\n	xorq	T5(,%%rbx,8), %%r11 # col1' += R(col6)"
       "\n	shrq	$16, %%rdx"

       "\n	movzbl	%%cl, %%edi"
       "\n	movzbl	%%ch, %%esi"
       "\n	movzbl	%%dl, %%eax"
       "\n	movzbl	%%dh, %%ebx"
       "\n	pxor	T6(,%%rdi,8), %%mm6 # col6' += R(col4)"
       "\n	pxor	T7(,%%rsi,8), %%mm5 # col5' += R(col4)"
       "\n	xorq	T6(,%%rax,8), %%r10 # col0' += R(col6)"
       "\n	pxor	T7(,%%rbx,8), %%mm7 # col7' += R(col6)"


       "\n	movq	%%r11, 8(%0)"
       "\n	movq	%%mm3, 24(%0)"
       "\n	movq	%%r10, 0(%0)"
       "\n	movq	%%mm2, 16(%0)"
       "\n	movq	%%mm4, 32(%0)"
       "\n	movq	%%mm5, 40(%0)"
       "\n	movq	%%mm6, 48(%0)"
       "\n	movq	%%mm7, 56(%0)"


       : /*no output, only memory is modified */
       : "r" (x) /* input variable: x */
       : "%rax", "%rbx", "%rcx", "%rdx", "%rdi", "%rsi", "%r8", "%r10", "%r11", "memory" , "%mm2" , "%mm3" , "%mm4" , "%mm5" , "%mm6" , "%mm7" );
}//Q512ASM()

